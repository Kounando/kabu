<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¶ç©ºã®æ ªä¾¡ãƒãƒ£ãƒ¼ãƒˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        canvas { max-width: 90%; margin: auto; }
        .controls { margin: 20px; }
        button { margin: 5px; padding: 10px 20px; font-size: 16px; }
        #balance, #history { margin-top: 20px; }
    </style>
</head>
<body>
    <h2>æ¶ç©ºã®æ ªä¾¡ãƒãƒ£ãƒ¼ãƒˆ</h2>
    <canvas id="stockChart"></canvas>

    <div class="controls">
        <button onclick="buyStock()">è²·ã†</button>
        <button onclick="sellStock()">å£²ã‚‹</button>
    </div>

    <div id="balance">ğŸ’° æ‰€æŒé‡‘: <span id="money">100000</span> å†† | ğŸ“ˆ æ ª: <span id="stocks">0</span> æ ª</div>
    <div id="history"><strong>å–å¼•å±¥æ­´:</strong></div>

    <script>
        let balance = 100000;  // æ‰€æŒé‡‘
        let stocks = 0;        // ä¿æœ‰æ ªæ•°
        let stockPrices = [];  // æ ªä¾¡ãƒ‡ãƒ¼ã‚¿
        let labels = [];       // æ—¥ä»˜ãƒ©ãƒ™ãƒ«
        let date = new Date();
        date.setDate(date.getDate() - 365);

        // æ ªä¾¡ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆï¼ˆãƒ©ãƒ³ãƒ€ãƒ ã‚¦ã‚©ãƒ¼ã‚¯ï¼‰
        function generateStockData(days, startPrice) {
            let prices = [startPrice];

            for (let i = 0; i < days; i++) {
                labels.push(date.toISOString().split('T')[0]); // YYYY-MM-DDå½¢å¼
                let change = (Math.random() - 0.5) * 2; // -1%ã€œ+1%ã®å¤‰å‹•
                prices.push(prices[prices.length - 1] * (1 + change / 100));
                date.setDate(date.getDate() + 1);
            }
            return prices;
        }

        stockPrices = generateStockData(365, 100);
        let currentPrice = stockPrices[stockPrices.length - 1];

        // æ ªä¾¡ãƒãƒ£ãƒ¼ãƒˆã®æç”»
        const ctx = document.getElementById("stockChart").getContext("2d");
        const chart = new Chart(ctx, {
            type: "line",
            data: {
                labels: labels,
                datasets: [{
                    label: "æ ªä¾¡ (å††)",
                    data: stockPrices,
                    borderColor: "blue",
                    backgroundColor: "rgba(0, 0, 255, 0.1)",
                    borderWidth: 2,
                    pointRadius: 0
                }]
            },
            options: {
                responsive: true,
                scales: {
                    x: { display: true },
                    y: { display: true }
                }
            }
        });

        // è²·ã†ãƒœã‚¿ãƒ³ã®å‡¦ç†
        function buyStock() {
            if (balance >= currentPrice) {
                balance -= currentPrice;
                stocks += 1;
                updateUI("âœ… è²·ã£ãŸ: " + currentPrice.toFixed(2) + " å††");
            } else {
                alert("ãŠé‡‘ãŒè¶³ã‚Šã¾ã›ã‚“ï¼");
            }
        }

        // å£²ã‚‹ãƒœã‚¿ãƒ³ã®å‡¦ç†
        function sellStock() {
            if (stocks > 0) {
                balance += currentPrice;
                stocks -= 1;
                updateUI("âŒ å£²ã£ãŸ: " + currentPrice.toFixed(2) + " å††");
            } else {
                alert("å£²ã‚‹æ ªãŒã‚ã‚Šã¾ã›ã‚“ï¼");
            }
        }

        // UIã‚’æ›´æ–°ã™ã‚‹é–¢æ•°
        function updateUI(message) {
            document.getElementById("money").innerText = balance.toFixed(2);
            document.getElementById("stocks").innerText = stocks;
            let historyDiv = document.getElementById("history");
            let newEntry = document.createElement("div");
            newEntry.innerText = message;
            historyDiv.appendChild(newEntry);
        }
    </script>
</body>
</html>
